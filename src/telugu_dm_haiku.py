# telugu_dm_haiku.py - తెలుగు dm-haiku అమలు

import math
import random

class హైకు_మాడ్యూల్:
    def __init__(self):
        self.పారామీటర్లు = {}

    def పారామీటర్_జోడించు(self, పేరు, ఆకారం):
        self.పారామీటర్లు[పేరు] = [random.uniform(-0.1, 0.1) for _ in range(ఆకారం)]

    def పారామీటర్_పొందు(self, పేరు):
        return self.పారామీటర్లు[పేరు]

class సంపూర్ణ_అనుసంధాన(హైకు_మాడ్యూల్):
    def __init__(self, ఇన్పుట్_పరిమాణం, అవుట్పుట్_పరిమాణం):
        super().__init__()
        self.పారామీటర్_జోడించు("బరువులు", ఇన్పుట్_పరిమాణం * అవుట్పుట్_పరిమాణం)
        self.పారామీటర్_జోడించు("బయాస్", అవుట్పుట్_పరిమాణం)
        self.ఇన్పుట్_పరిమాణం = ఇన్పుట్_పరిమాణం
        self.అవుట్పుట్_పరిమాణం = అవుట్పుట్_పరిమాణం

    def ముందుకు_ప్రసారం(self, ఇన్పుట్):
        బరువులు = self.పారామీటర్_పొందు("బరువులు")
        బయాస్ = self.పారామీటర్_పొందు("బయాస్")
        అవుట్పుట్ = []
        for i in range(self.అవుట్పుట్_పరిమాణం):
            మొత్తం = బయాస్[i]
            for j in range(self.ఇన్పుట్_పరిమాణం):
                మొత్తం += ఇన్పుట్[j] * బరువులు[i * self.ఇన్పుట్_పరిమాణం + j]
            అవుట్పుట్.append(మొత్తం)
        return అవుట్పుట్

class సక్రియణ(హైకు_మాడ్యూల్):
    def __init__(self, ఫంక్షన్):
        super().__init__()
        self.ఫంక్షన్ = ఫంక్షన్

    def ముందుకు_ప్రసారం(self, ఇన్పుట్):
        return [self.ఫంక్షన్(x) for x in ఇన్పుట్]

def రెలు(x):
    return max(0, x)

def సిగ్మాయిడ్(x):
    return 1 / (1 + math.exp(-x))

def టాన్హ్(x):
    return math.tanh(x)

class హైకు_మోడల్:
    def __init__(self, మాడ్యూల్స్):
        self.మాడ్యూల్స్ = మాడ్యూల్స్

    def ముందుకు_ప్రసారం(self, ఇన్పుట్):
        for మాడ్యూల్ in self.మాడ్యూల్స్:
            ఇన్పుట్ = మాడ్యూల్.ముందుకు_ప్రసారం(ఇన్పుట్)
        return ఇన్పుట్

def మోడల్_నిర్మించు(నిర్మాణం):
    మాడ్యూల్స్ = []
    for పొర in నిర్మాణం:
        if పొర[0] == "సంపూర్ణ_అనుసంధాన":
            మాడ్యూల్స్.append(సంపూర్ణ_అనుసంధాన(పొర[1], పొర[2]))
        elif పొర[0] == "సక్రియణ":
            if పొర[1] == "రెలు":
                మాడ్యూల్స్.append(సక్రియణ(రెలు))
            elif పొర[1] == "సిగ్మాయిడ్":
                మాడ్యూల్స్.append(సక్రియణ(సిగ్మాయిడ్))
            elif పొర[1] == "టాన్హ్":
                మాడ్యూల్స్.append(సక్రియణ(టాన్హ్))
    return హైకు_మోడల్(మాడ్యూల్స్)

if __name__ == "__main__":
    # ఉదాహరణ ఉపయోగం
    మోడల్ = మోడల్_నిర్మించు([
        ("సంపూర్ణ_అనుసంధాన", 2, 3),
        ("సక్రియణ", "రెలు"),
        ("సంపూర్ణ_అనుసంధాన", 3, 1),
        ("సక్రియణ", "సిగ్మాయిడ్")
    ])

    ఇన్పుట్ = [0.5, -0.5]
    అవుట్పుట్ = మోడల్.ముందుకు_ప్రసారం(ఇన్పుట్)
    print("మోడల్ అవుట్పుట్:", అవుట్పుట్)
